<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Especialistas – Clínica POTOSÍ</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    body {
      background: #fafafa;
      font-family: 'Segoe UI', sans-serif;
    }

    .header {
      background: #C62828;
      color: white;
      padding: 15px 30px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 3.5rem;
      font-weight: bold;
    }

    .navbar-links {
      background: white;
      display: flex;
      justify-content: center;
      gap: 35px;
      padding: 12px 0;
      border-bottom: 1px solid #ddd;
      font-size: 1rem;
    }
    .navbar-links a {
      color: #333;
      text-decoration: none;
      padding: 6px 12px;
      border-radius: 8px;
      transition: 0.2s;
    }
    .navbar-links a:hover,
    .navbar-links .active {
      background: #C62828;
      color: white;
    }

    .container-pro {
      max-width: 1100px;
      margin: auto;
      padding: 25px;
    }

    .section-title {
      text-align: center;
      font-size: 2rem;
      font-weight: 700;
      color: #C62828;
      margin-bottom: 30px;
    }

    table {
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .modal-pro {
      position: fixed;
      inset: 0;
      display: none;
      background: rgba(0,0,0,0.55);
      justify-content: center;
      align-items: center;
    }
    .modal-pro.active {
      display: flex;
    }
    .modal-box {
      background: white;
      width: 420px;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.25);
      animation: fadeIn 0.2s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.95); }
      to   { opacity: 1; transform: scale(1); }
    }

    .footer {
      background: white;
      padding: 15px;
      text-align: center;
      margin-top: 50px;
      border-top: 1px solid #ccc;
      color: #888;
    }
  </style>
</head>

<body>

<header class="header">
  Clínica Privada "Fe y Alegría"
  <div class="small">Usuario: <strong>Admin</strong> · <a href="#" class="text-white">Cerrar sesión</a></div>
</header>

<nav class="navbar-links">
  <a href="index.html">Inicio</a>
  <a href="servicios.html">Servicios Médicos</a>
  <a href="especialistas.html" class="active">Especialistas</a>
  <a href="multimedia.html">Multimedia</a>
  <a href="contacto.html">Contacto</a>
  <a href="reportes.html">Reportes</a>
  <a href="citas.html">Reservar Citas</a>
</nav>

<main class="container-pro">

  <h2 class="section-title">Gestión de Especialistas</h2>

  <div class="d-flex justify-content-end mb-3">
    <button id="btnNew" class="btn btn-danger">+ Agregar Especialista</button>
  </div>

  <table class="table table-hover align-middle">
    <thead class="table-dark">
      <tr>
        <th>ID</th>
        <th>Nombre</th>
        <th>Especialidad</th>
        <th>Horario</th>
        <th>Contacto</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody id="tb-especialistas"></tbody>
  </table>

</main>

<div class="modal-pro" id="modalEsp">
  <div class="modal-box">
    <h4 id="modalTitle" class="mb-3">Registro de Especialista</h4>

    <form id="frm-especialista">
      <input type="hidden" name="id">

      <label>Nombre</label>
      <input class="form-control mb-2" name="nombre" required>

      <label>Especialidad</label>
      <select class="form-control mb-2" name="especialidad" required>
        <option value="">Seleccione</option>
        <option>Cardiología</option>
        <option>Pediatría</option>
        <option>Dermatología</option>
        <option>Ginecología</option>
        <option>Traumatología</option>
        <option>Oftalmología</option>
        <option>Odontología</option>
        <option>Neurología</option>
        <option>Psiquiatría</option>
        <option>Nutrición</option>
        <option>Urología</option>
        <option>Gastroenterología</option>
        <option>Endocrinología</option>
        <option>Reumatología</option>
        <option>Medicina Interna</option>
      </select>

      <label>Horario</label>
      <select class="form-control mb-2" name="horario" required>
        <option value="">Seleccione</option>
        <option>Lunes a Viernes 08:00–12:00</option>
        <option>Lunes a Viernes 14:00–18:00</option>
        <option>Martes y Jueves 09:00–13:00</option>
        <option>Lunes, Miércoles y Viernes 09:00–12:00</option>
        <option>Martes a Sábado 10:00–15:00</option>
        <option>Lunes a Sábado 09:00–17:00</option>
        <option>Miércoles y Viernes 09:00–13:00</option>
        <option>Lunes a Viernes 07:00–11:00</option>
        <option>Sábado y Domingo 08:00–12:00</option>
      </select>

      <label>Contacto</label>
      <input class="form-control mb-3" name="contacto" required>

      <div class="d-flex gap-2">
        <button type="submit" class="btn btn-danger">Guardar</button>
        <button type="button" class="btn btn-secondary" id="btnClose">Cancelar</button>
      </div>
    </form>
  </div>
</div>

<footer class="footer">
  Clínica Privada "Fe y Alegría" · Potosí, Bolivia
</footer>

<script>
const API = "api/especialistas.php";
const tbody = document.getElementById("tb-especialistas");
const modal = document.getElementById("modalEsp");
const form = document.getElementById("frm-especialista");
const btnNew = document.getElementById("btnNew");
const btnClose = document.getElementById("btnClose");

async function cargar() {
  const res = await fetch(API);
  const data = await res.json();

  tbody.innerHTML = data.map(e => `
    <tr>
      <td>${e.id}</td>
      <td>${e.nombre}</td>
      <td>${e.especialidad}</td>
      <td>${e.horario}</td>
      <td>${e.contacto}</td>
      <td>
        <button class="btn btn-warning btn-sm" onclick="editar(${e.id})">Editar</button>
        <button class="btn btn-dark btn-sm" onclick="eliminar(${e.id})">Eliminar</button>
      </td>
    </tr>
  `).join("");
}

cargar();

btnNew.onclick = () => {
  form.reset();
  form.id.value = "";
  modal.classList.add("active");
};

btnClose.onclick = () => modal.classList.remove("active");

async function editar(id) {
  const res = await fetch(API + "?id=" + id);
  const esp = await res.json();

  form.id.value = esp.id;
  form.nombre.value = esp.nombre;
  form.especialidad.value = esp.especialidad;
  form.horario.value = esp.horario;
  form.contacto.value = esp.contacto;

  modal.classList.add("active");
}

form.onsubmit = async e => {
  e.preventDefault();

  const datos = {
    nombre: form.nombre.value,
    especialidad: form.especialidad.value,
    horario: form.horario.value,
    contacto: form.contacto.value
  };

  let res;

  if (form.id.value === "") {
    res = await fetch(API, {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify(datos)
    });
  } else {
    res = await fetch(API + "?id=" + form.id.value, {
      method: "PUT",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify(datos)
    });
  }

  modal.classList.remove("active");
  cargar();
};

async function eliminar(id) {
  if (!confirm("¿Eliminar especialista?")) return;
  await fetch(API + "?id=" + id, {method: "DELETE"});
  cargar();
}
</script>

</body>
</html>
